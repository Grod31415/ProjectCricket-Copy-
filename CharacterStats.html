<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset = "UTF-8">
        <title>Character Stats</title>
        <link rel="stylesheet" href="StyleSheet.css">
        <link rel="icon" type = "image/x-icon" href="https://raw.github.com/oneslinky/ProjectCricket/76f773d4979e9031c0e8b017f510a429897650b2/assests/favicon/Favicon%20Black%20Background%20Square.png">
        <!--<link rel="icon" tpye = "image/x-icon" href="/images/Favicon (Black).png"> for local use -->
    </head>
    <body style = "background-image:url('https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stats%20Background.png');background-size: cover; background-repeat: no-repeat;">
    
        <h1>
           <strong>Character Overview</strong> 
        </h1>
        <p>
            This is where character stats will be displayed after submission.
        </p>
        <h2>
            <strong>Character Story Overview</strong>
        </h2>
        <p>
            This section will provide a brief overview of the character, including their name, age, and background story.
        </p>





        /* Character image */
        <img id="portrait" alt="Character portrait" style="max-width: 256px;" />


        
        
        
        <div id="confirmbackPopup" class = "overlay">
            <div class = "popup">
                <h2>Confirm Navigation</h2>
                <p>Are you sure you want to return to the Character Submission page? Any unsaved changes will be lost.</p>
                <button onclick="document.getElementById('confirmbackPopup').style.display='none';">Cancel</button>
                <button id="confirmBackYes">Go Back</button>
            </div>
        </div>
        <div id="confirmsubmitPopup" class = "overlay">
            <div class = "popup">
                <h2>Confirm Submission</h2>
                <p>Are you sure you want to confirm this character? Once confirmed, you will not be able to make further changes and will be unable to go back.</p>
                <button onclick="document.getElementById('confirmsubmitPopup').style.display='none';">Cancel</button>
                <button onclick="window.location.href='Loading.html';">Confirm</button>
            </div>
        </div>
        <aside class="panel panel--top-right" aria-label="Character stats and image">
            <div style="display:flex; gap:12px; align-items:flex-start;">
                   <div class="panel stats">
                    <img class="stat-icon" src="https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stat%20Icons/HP.png" alt="Health">
                    
                    <pre id="HP"></pre>
                       
                    <img class="stat-icon" src="https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stat%20Icons/MP.png" alt="Mana">

                    <pre id="MP"></pre>
                       
                    <img class="stat-icon" src="https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stat%20Icons/ATK.png" alt="Attack">

                    <pre id="ATK"></pre>
                       
                    <img class="stat-icon" src="https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stat%20Icons/DEF.png" alt="Defense">

                    <pre id="DEF"></pre>
                       
                    <img class="stat-icon" src="https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stat%20Icons/AGI.png" alt="Speed">

                    <pre id="AGI"></pre>
                       
                    <img class="stat-icon" src="https://raw.github.com/oneslinky/ProjectCricket/8730df2a31fbdbc0f0a4c60121ff8c76fc12ef6e/assests/Stat%20Icons/LUK.png" alt="Luck">

                    <pre id="LUK"></pre>
                       
                </div>
            </div>
        </aside>
        
        <section class="panel skills panel--bottom-center" aria-label="Skills">
            <div style="width:98%; text-align:center;">
                <div class="panel-title">SKILLS</div>
                <div class="single-line" style="color:#093049; opacity:0.95; margin-top:6px;">Add skill descriptions.</div>
                <div class="panel-buttons" style="margin-top:12px; display:flex; gap:12px; justify-content:center;">
                    <button id="backButton">Return to Character Submission Page</button>
                    <button id="submitBtn">Confirm character</button>
                </div>
            </div>
        </section>
        <script>

            
            /* 1) Where the Flask API is running */
            if (!window.API_BASE) {
                window.API_BASE = "http://127.0.0.1:8888";
            }
            
            
            function showbackpopup(){
                document.getElementById('confirmbackPopup').style.display='flex';
            }
            function showsubmitpopup(){
                document.getElementById('confirmsubmitPopup').style.display='flex';
            }
            document.getElementById("backButton").onclick = function () {
                showbackpopup();
            };
            document.getElementById('confirmBackYes').addEventListener('click', function(){
                try{
                    sessionStorage.setItem('suppressDisclaimerOnReturn', '1');
                }catch(e){
                }
                window.location.href = 'CharacterSubmission.html';
            });
            document.getElementById("submitBtn").onclick = function () {
                showsubmitpopup();
            };
        </script>
    </body>



    /* Addition */
    <script>
  if (!window.API_BASE) window.API_BASE = "http://127.0.0.1:8888";

  const raw = sessionStorage.getItem('gen_result');
  if (!raw) { location.href = 'CharacterSubmission.html'; }
  const payload = JSON.parse(raw);

  // If backend gave a relative path ("/static/gen/..."), prefix API_BASE
  const imgUrl = payload.image_url?.startsWith('http')
    ? payload.image_url
    : `${API_BASE}${payload.image_url}`;

  const portrait = document.getElementById('portrait');
  if (portrait) portrait.src = imgUrl;

  const stats = document.getElementById('stats');
  if (stats) stats.textContent = JSON.stringify(payload.stats, null, 2);

  const abilities = document.getElementById('abilities');
  if (abilities) {
    abilities.innerHTML = (payload.abilities || [])
      .map(a => `<li><strong>${a.name}</strong> â€” ${a.description} (Power ${a.power})</li>`)
      .join('');
  }
</script>

    /* End */


    
</html>
